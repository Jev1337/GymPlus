{% extends "main/base.html.twig" %}

{% block content %}
   <div class="page-content bg-white">		
      <!-- banner -->
      <div class="contact-bnr" style="background-image: url({{ asset('main/images/background/bg9.png') }});">
         <div class="container">
            <div class="row">
               <div class="col-lg-6">
							{{ mukadi_chart(chart) }}

                  <button class="my-button" onclick="startArduinoData()">Start</button>
                  <button class="my-button" onclick="stopArduinoData()">Quit</button>
                    <button onclick="generateChart()">Generate Chart</button>

               </div>
            </div>
         </div>
      </div>
   </div>
{% endblock %}



{% block js %}
    {{ parent() }}
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.2.1/chart.umd.min.js"></script>
    <script src="/bundles/mukadichartjs/mukadi.chart.min.js"></script>
   <script>
      var arduinoDataRunning = false;
      var xhr;

      function startArduinoData() {
         if (arduinoDataRunning) {
            alert('Arduino data retrieval is already running.');
            return;
         }

         xhr = new XMLHttpRequest();
         xhr.open('GET', '{{ path('app_StroringData') }}', true);
         xhr.onreadystatechange = function () {
            if (xhr.readyState === XMLHttpRequest.DONE) {
               if (xhr.status === 200) {
                  alert(xhr.responseText);
               } else {
                  alert('Failed to retrieve Arduino data.');
               }
            }
         };
         xhr.send();
         arduinoDataRunning = true;
      }

      function stopArduinoData() {
         if (!arduinoDataRunning) {
            alert('Arduino data retrieval is not running.');
            return;
         }

         if (xhr) {
            xhr.abort();
         }
         arduinoDataRunning = false;
      }

function generateChart() {
  window.location.href = "{{ path('app_Tracker') }}";
}

















   </script>
{% endblock %}