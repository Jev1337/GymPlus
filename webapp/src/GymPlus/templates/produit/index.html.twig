{# {% extends 'base.html.twig' %} #}
{% extends "main/base.html.twig" %}


{# {% block title %}Produit index{% endblock %} #}

{# {% block body %} #}

{% block content %}

<div class="page-content bg-white">
		
		<!-- Banner  -->
		<div class="dz-bnr-inr style-2" style="background-image: url('{{asset('main/images/banner/banner-2.png')}}')">
			<div class="banner-gradient"></div>
			<div class="container">
				<div class="row">
					<div class="col-lg-8">
						<div class="dz-bnr-inr-entry">
							<h1>Shop</h1>
							<!-- Breadcrumb Row -->
							<nav aria-label="breadcrumb" class="breadcrumb-row">
								<ul class="breadcrumb">
									<li class="breadcrumb-item"><a href="index.html">Home</a></li>
									
									<li class="breadcrumb-item active" aria-current="page">Shop</li>
								</ul>
							</nav>
							<!-- Breadcrumb Row End -->
						</div>
					</div>
				</div>	
				<div class="banner-media">
					<img src="{{asset('main/images/banner/pic4.png')}}" alt="/">
				</div>
			</div>	
		</div>


    
<br>
    <a href="{{ path('app_panier') }}" id="valider-panier" data-url="{{ path('valider_panier') }}" class="btn btn-primary btn-skew appointment-btn"><span class="skew-inner"><span class="text"> Check Cart </span></span></a>
    {# <a href="{{ path('app_panier') }}">check Panier</a> #}
    <br>
 
<br>

    <h2>recently added :</h2>
    <table class="table">
        <thead>
            <tr>
                <th>Idproduit</th>
                <th>Name</th>
                <th>Prix</th>
                <th>Stock</th>
                <th>Description</th>
                <th>Categorie</th>
                <th>Photo</th>
                <th>Seuil</th>
                <th>Promo</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody>
        {% for latestProduct in latestProducts %}
            <tr>
                <td>{{ latestProduct.idproduit }}</td>
                <td>{{ latestProduct.name }}</td>
                <td>{{ latestProduct.prix }}</td>
                <td>{{ latestProduct.stock }}</td>
                <td>{{ latestProduct.description }}</td>
                <td>{{ latestProduct.categorie }}</td>
                <td> 
                    <img src="{{ asset('images/img_product/' ~ latestProduct.photo) }}" alt="" width="100">
                </td>
                <td>{{ latestProduct.seuil }}</td>
                <td>{{ latestProduct.promo }}</td>
                <td>
                    <a href="{{ path('app_produit_show', {'idproduit': latestProduct.idproduit}) }}">show Product</a>
                    {# <a href="{{ path('app_produit_edit', {'idproduit': latestProduct.idproduit}) }}">edit</a> #}
                    <br>
                    <a href="{{ path('panier_add', {'idproduit': latestProduct.idproduit}) }}">Add to Cart</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="10">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    <hr> <!-- Séparateur entre les deux tableaux -->

    <h2>Liste complète des produits :</h2>
    {# <table class="table"> #}
       
            <input id="search-input" type="form-control" placeholder="Chercher..." style="width: 400px; border-radius: 10px;" >
            <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
            <script>
                $(document).ready(function() {
                    $("#search-input").on("keyup", function() {
                        var value = $(this).val().toLowerCase();
                        // Sélectionner les lignes du deuxième tableau seulement
                        $("#complete-products-table tbody tr").filter(function() {
                            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
                        });
                    });
                });
            </script>

            <select id="category-filter">
                <option value="">Toutes les catégories</option>
                <option value="food">Food</option>
                <option value="vetement">Vêtement</option>
                <option value="equipement">Équipement</option>
            </select>

            <script>
                $(document).ready(function() {
                    $("#category-filter").on("change", function() {
                        var category = $(this).val().toLowerCase();
                        filterByCategory(category);
                    });

                    function filterByCategory(category) {
                        $("#complete-products-table tbody tr").each(function() {
                            var rowCategory = $(this).find("td:eq(5)").text().toLowerCase(); // Index 5 corresponds to the column containing the category
                            if (category === "" || rowCategory === category) {
                                $(this).show();
                            } else {
                                $(this).hide();
                            }
                        });
                    }
                });
            </script>

    <select id="sort-select">
        <option value="asc">Croissant</option>
        <option value="desc">Décroissant</option>
    </select>

    <script>
        $(document).ready(function() {
            $("#sort-select").on("change", function() {
                var order = $(this).val();
                sortTableByPrice(order);
            });

            function sortTableByPrice(order) {
                var rows = $("#complete-products-table tbody tr").get();

                rows.sort(function(a, b) {
                    var priceA = parseFloat($(a).find("td:eq(2)").text()); // Index 2 corresponds to the column containing the price
                    var priceB = parseFloat($(b).find("td:eq(2)").text());

                    if (order === 'asc') {
                        return priceA - priceB;
                    } else {
                        return priceB - priceA;
                    }
                });

                $("#complete-products-table tbody").empty(); // Clear the table body

                $.each(rows, function(index, row) {
                    $("#complete-products-table tbody").append(row);
                });
            }
        });
    </script>




    <table class="table" id="complete-products-table">

        <thead>
            <tr>
                <th>Idproduit</th>
                <th>Name</th>
                <th>Prix</th>
                <th>Stock</th>
                <th>Description</th>
                <th>Categorie</th>
                <th>Photo</th>
                <th>Seuil</th>
                <th>Promo</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody>
        {% for produit in produits %}
            <tr>
                <td>{{ produit.idproduit }}</td>
                <td>{{ produit.name }}</td>
                <td>{{ produit.prix }}</td>
                <td>{{ produit.stock }}</td>
                <td>{{ produit.description }}</td>
                <td>{{ produit.categorie }}</td>
                <td> 
                    <img src="{{ asset('images/img_product/' ~ produit.photo) }}" alt="" width="100">
                </td>
                <td>{{ produit.seuil }}</td>
                <td>{{ produit.promo }}</td>
                <td>
                    <a href="{{ path('app_produit_show', {'idproduit': produit.idproduit}) }}">show</a>
                    <a href="{{ path('app_produit_edit', {'idproduit': produit.idproduit}) }}">edit</a>
                    <a href="{{ path('panier_add', {'idproduit': produit.idproduit}) }}">Ajouter</a>
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="10">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

{% endblock %}