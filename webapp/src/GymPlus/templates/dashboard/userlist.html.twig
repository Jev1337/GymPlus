

{% extends 'dashboard/base.html.twig' %}

{% block css %}
	<!-- Datatable -->
	<link href="{{asset('dashboard/vendor/datatables/css/jquery.dataTables.min.css')}}" rel="stylesheet">
	{{ parent() }}
{% endblock %}

{% block content %}
        <div class="content-body">
            <div class="container-fluid">
                <div class="page-titles">
					<ol class="breadcrumb">
						<li class="breadcrumb-item"><a href="javascript:void(0)">App</a></li>
						<li class="breadcrumb-item active"><a href="javascript:void(0)">Profile</a></li>
					</ol>
                </div>
                <!-- row -->
				<div class="alert alert-warning solid alert-right-icon alert-dismissible fade show">
					<span><i class="mdi mdi-alert"></i></span>
						<button type="button" class="close h-100" data-dismiss="alert" aria-label="Close"><span><i class="mdi mdi-close"></i></span>
					</button>
					<strong>Warning!</strong> As an admin, you have the ability to manage users, you can add, modify or delete users aswell as bypass verification processes. Be careful with the actions you take as they are irreversible.
				</div>
				<div class="row">
					<div class="col-lg-12">
						<div class="card">
							<div class="card-header">
								<h4 class="card-title">Add User</h4>
							</div>
							<div class="card-body">
							{% for message in app.flashes('error') %}
								<div class="alert alert-danger solid alert-right-icon alert-dismissible fade show">
								<span><i class="mdi mdi-alert"></i></span>
									<button type="button" class="close h-100" data-dismiss="alert" aria-label="Close"><span><i class="mdi mdi-close"></i></span>
								</button>
								<strong>Error!</strong> {{ message }}
							</div>
							{% endfor %}
							{{ form_start(form, { 'class': 'centered-form'}) }}
								<div class="form-row">
									<div class="form-group col-md-4">
										{{ form_label(form.id) }}
										{{ form_widget(form.id, {'attr' : {'class' : 'form-control'}}) }}
										<small class="text-danger">{{ form_errors(form.id) }}</small>
									</div>
									<div class="form-group col-md-4">
										{{ form_label(form.username) }}
										{{ form_widget(form.username, {'attr' : {'class' : 'form-control'}}) }}
										<small class="text-danger">{{ form_errors(form.username) }}</small>
									</div>
									<div class="form-group col-md-4">
										{{ form_label(form.firstname) }}
										{{ form_widget(form.firstname, {'attr' : {'class' : 'form-control'}}) }}
										<small class="text-danger">{{ form_errors(form.firstname) }}</small>
									</div>
								</div>
								<div class="form-row">
									<div class="form-group col-md-4">
										{{ form_label(form.lastname) }}
										{{ form_widget(form.lastname, {'attr' : {'class' : 'form-control'}}) }}
										<small class="text-danger">{{ form_errors(form.lastname) }}</small>
									</div>
									<div class="form-group col-md-4">
										{{ form_label(form.dateNaiss) }}
										{{ form_widget(form.dateNaiss, {'attr' : {'class' : 'form-control'}}) }}
										<small class="text-danger">{{ form_errors(form.dateNaiss) }}</small>
									</div>
									<div class="form-group col-md-4">
										{{ form_label(form.password) }}
										{{ form_widget(form.password, {'attr' : {'class' : 'form-control'}}) }}
										<small class="text-danger">{{ form_errors(form.password) }}</small>
									</div>
								</div>
								<div class="form-row">
									<div class="form-group col-md-4">
										{{ form_label(form.email) }}
										{{ form_widget(form.email, {'attr' : {'class' : 'form-control'}}) }}
										<small class="text-danger">{{ form_errors(form.email) }}</small>
									</div>
									
									<div class="form-group col-md-4">
										{{ form_label(form.adresse) }}
										{{ form_widget(form.adresse, {'attr' : {'class' : 'form-control'}}) }}
										<small class="text-danger">{{ form_errors(form.adresse) }}</small>
									</div>
									<div class="form-group col-md-2">
										{{ form_label(form.numTel) }}
										{{ form_widget(form.numTel, {'attr' : {'class' : 'form-control'}}) }}
										<small class="text-danger">{{ form_errors(form.numTel) }}</small>
									</div>
									<div class="form-group col-md-2">
										{{ form_label(form.role) }}
										{{ form_widget(form.role, {'attr' : {'class' : 'form-control'}}) }}
										<small class="text-danger">{{ form_errors(form.role) }}</small>
									</div>
								</div>
								<div class="form-row">
									
									<div class="form-group col-md-4">
										<div class="custom-file">
											
											{{ form_widget(form.photo, {'attr' : {'class' : 'custom-file-input'}}) }}
											{{ form_label(form.photo, null, { 'label_attr': {'class': 'custom-file-label'} }) }}
										</div>
									</div>
								</div>
								
								<button type="submit" class="btn btn-primary">Add User</button>
							{{ form_end(form) }}
							</div>
							
						</div>
					</div>
				</div>
                <div class="row">
					<div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h4 class="card-title">Users</h4>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table id="example5" class="display min-w850">
                                        <thead>
                                            <tr>
												<th></th>
                                                <th>User CIN</th>
												<th>First Name</th>
												<th>Last Name</th>
												<th>Phone</th>
												<th>Email</th>
												<th>Address</th>
												<th>Role</th>
												<th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
											{% for u in users %}

                                            <tr>
												<td><img src="{{asset('profileuploads/'~u.photo)}}" class="rounded-circle" width="35" alt=""></td>
												<td>{{ u.id }}</td>
												<td>{{ u.firstname }}</td>
												<td>{{ u.lastname }}</td>
												<td>{{ u.numtel }}</td>
												<td>{{ u.email }}</td>
												<td>{{ u.adresse }}</td>
												<td>
													{% if u.role == 'client' %}
													<span class="badge light badge-success">
														<i class="fa fa-circle text-success mr-1"></i>
													{% elseif u.role == 'admin' %}
													<span class="badge light badge-danger">
														<i class="fa fa-circle text-danger mr-1"></i>
													{% else %}
													<span class="badge light badge-warning">
														<i class="fa fa-circle text-warning mr-1"></i>
													{% endif %}
														{{ u.role | capitalize}}
													</span>
												</td>
												<td>
													<div class="dropdown ms-auto text-end c-pointer">
														<div class="btn-link" data-toggle="dropdown">
															<svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect x="0" y="0" width="24" height="24"></rect><circle fill="#000000" cx="5" cy="12" r="2"></circle><circle fill="#000000" cx="12" cy="12" r="2"></circle><circle fill="#000000" cx="19" cy="12" r="2"></circle></g></svg>
														</div>
														<div class="dropdown-menu dropdown-menu-right">
															<a class="dropdown-item" onmouseover="this.classList.add('bg-warning'); this.classList.add('text-white')" onmouseout="this.classList.remove('bg-warning');  this.classList.remove('text-white')" href="{{ path('app_user_edit', {'id': u.id}) }}"><i class="fa fa-pencil me-2"></i> Modify User</a>
															<a class="dropdown-item" onmouseover="this.classList.add('bg-danger'); this.classList.add('text-white')" onmouseout="this.classList.remove('bg-danger');  this.classList.remove('text-white')" href="{{ path('app_user_delete', {'id': u.id}) }}"><i class="fa fa-trash me-2"></i> Delete User</a>
														</div>
													</div>
												</td>										
                                            </tr>
											{% endfor %}
                                            
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
				</div>
                    
			</div>
        </div>
        <!--**********************************
            Content body end
        ***********************************-->
{% endblock %}

{% block js %}
	{{ parent() }}
	<!-- Datatable -->
	<script src="{{asset('dashboard/vendor/datatables/js/jquery.dataTables.min.js')}}"></script>
	<script src="{{asset('dashboard/js/plugins-init/datatables.init.js')}}"></script>
{% endblock %}